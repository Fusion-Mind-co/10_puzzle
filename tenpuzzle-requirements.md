# 10パズル 要件定義書

## 1. プロジェクト概要

### 1.1 目的
4つの数字と四則演算を使って10を作る「10パズル」をWebアプリケーションとして実装する。
Django学習を兼ねた開発プロジェクト。

### 1.2 ゲーム概要
- 4つの数字が出題される
- ボタン操作で数字と演算子を選択し、段階的に計算を行う
- 最終的に10を作ることができればクリア
- 全552問のクリアを目指す

---

## 2. 技術要件

### 2.1 使用技術
- **バックエンド**: Django
- **データベース**: SQLite
- **フロントエンド**: Django Template + vanilla JavaScript + CSS
- **その他**: HTML5

### 2.2 動作環境
- Python 3.x
- モダンブラウザ（Chrome, Firefox, Safari, Edge）

---

## 3. 機能要件

### 3.1 問題管理機能

#### 3.1.1 問題データ
- 全552問の解答可能な組み合わせをCSVで管理
- CSVフォーマット: `number1,number2,number3,number4`

#### 3.1.2 問題インポート
- DjangoマネジメントコマンドでCSVを読み込み
- データベースに問題を登録

### 3.2 ゲームプレイ機能

#### 3.2.1 問題出題
- 未クリアの問題からランダムに1問出題
- 出題時に出題日時を記録
- 進捗状況を表示（例: 123/552問クリア）

#### 3.2.2 ゲーム画面構成
**表示要素:**
- 進捗表示（クリア済み問題数/552）
- 使える数字のボタン（初期4個、計算後は増減）
- 四則演算ボタン（+、-、×、÷）
- スキップボタン
- リセットボタン
- オプションボタン

#### 3.2.3 計算ロジック
**操作フロー:**
1. 数字ボタンをクリック（1つ目の数字を選択）
2. 演算子ボタンをクリック
3. 数字ボタンをクリック（2つ目の数字を選択）
4. 計算結果が新しい数字ボタンとして追加される
5. 使用した2つの数字は削除される
6. 手順1に戻る（残り1つの数字になるまで繰り返し）

**クリア判定:**
- 数字が1つになり、その値が10の場合にクリア
- クリア時にクリア日時を記録
- `is_cleared`フラグをtrueに設定

#### 3.2.4 スキップ機能
- 現在の問題を飛ばして次の問題へ移動
- スキップした問題は未クリアのまま残る
- 出題日時は更新しない

#### 3.2.5 リセット機能
- 現在の問題を最初からやり直す
- リセット回数（`reset_count`）をインクリメント
- 出題日時は維持

### 3.3 履歴管理機能

#### 3.3.1 履歴削除
**個別削除:**
- 特定の問題の履歴を削除
- 問題を未クリア状態に戻す

**全削除:**
- 全552問の履歴を一括削除
- すべての問題を初期状態に戻す

#### 3.3.2 オプション機能（将来実装予定）
- 統計情報表示
- ルール説明
- 音声ON/OFF
- その他の設定

---

## 4. データベース設計

### 4.1 テーブル定義

#### Problemテーブル
| カラム名 | 型 | NULL | 説明 |
|---------|-----|------|------|
| id | Integer | NO | 主キー（自動採番） |
| number1 | Integer | NO | 1つ目の数字 |
| number2 | Integer | NO | 2つ目の数字 |
| number3 | Integer | NO | 3つ目の数字 |
| number4 | Integer | NO | 4つ目の数字 |
| is_cleared | Boolean | NO | クリア済みフラグ（初期値: False） |
| reset_count | Integer | NO | リセット回数（初期値: 0） |
| started_at | DateTime | YES | 出題日時 |
| cleared_at | DateTime | YES | クリア日時 |

**制約:**
- ユニーク制約: (number1, number2, number3, number4)

---

## 5. 画面設計

### 5.1 ゲーム画面レイアウト

```
┌─────────────────────────────────┐
│   10パズル     123/552問クリア   │
├─────────────────────────────────┤
│                                 │
│        使える数字:              │
│     [ 1 ] [ 1 ] [ 2 ] [ 3 ]     │
│                                 │
│        演算子:                  │
│     [ + ] [ - ] [ × ] [ ÷ ]     │
│                                 │
├─────────────────────────────────┤
│   [スキップ] [リセット] [⚙️]     │
└─────────────────────────────────┘
```

### 5.2 UI/UX要件

#### 5.2.1 ボタン状態
- **数字ボタン**
  - 選択中: ハイライト表示
  - 計算結果: 元の数字と区別できる色
  - 使用済み: 非表示または無効化

- **演算子ボタン**
  - 数字未選択時: 無効化
  - 数字選択後: 有効化

#### 5.2.2 フィードバック
- 計算実行時のアニメーション
- クリア時の演出
- エラー時のメッセージ表示

---

## 6. 非機能要件

### 6.1 パフォーマンス
- 画面遷移は1秒以内
- ボタン操作の反応は即座に

### 6.2 ユーザビリティ
- 直感的に操作できるUI
- スマートフォンでも操作可能（レスポンシブ対応）

### 6.3 保守性
- コードの可読性を重視
- Django学習用として理解しやすい構造

---

## 7. 開発スコープ

### 7.1 初期実装（必須）
- [ ] 問題データのCSVインポート
- [ ] ランダム出題機能
- [ ] ゲーム画面
- [ ] 計算ロジック
- [ ] クリア判定
- [ ] スキップ機能
- [ ] リセット機能
- [ ] 進捗表示

### 7.2 第二フェーズ（オプション実装後）
- [ ] 履歴削除機能
- [ ] 統計情報表示
- [ ] オプションメニュー
- [ ] その他の拡張機能

---

## 8. 制約事項

### 8.1 技術的制約
- Django必須（学習目的のため）
- データベースはSQLite固定

### 8.2 ゲームルール
- 四則演算のみ使用可能
- 各数字は1回のみ使用
- 計算結果は小数も含む（10.0も正解）
- 割り算でゼロ除算は不可

---

## 9. 用語定義

| 用語 | 定義 |
|------|------|
| 10パズル | 4つの数字と四則演算を使って10を作るパズルゲーム |
| 問題 | 4つの数字の組み合わせ（1問） |
| クリア | 計算結果が10になること |
| スキップ | 問題を飛ばして次の問題に移ること |
| リセット | 現在の問題を最初からやり直すこと |
| 履歴 | 各問題のプレイ記録（クリア状態、日時など） |

---

## 10. 今後の検討事項

- オプションメニューの具体的な内容
- ユーザー認証機能の必要性
- 複数プレイヤー対応
- タイムアタックモード
- ヒント機能
